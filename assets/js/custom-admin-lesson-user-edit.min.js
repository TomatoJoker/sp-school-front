document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".js-save-feedback-button").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var e=this.closest(".js-student-feedback-form"),t=(console.log(e),new FormData);t.append("action","save_student_feedback"),t.append("security",ajaxHandler.nonce),t.append("lesson_id",e.querySelector('input[name="lesson_id"]').value),t.append("student_id",e.querySelector('input[name="student_id"]').value),t.append("feedback",e.querySelector('textarea[name="feedback"]').value),t.append("notes",e.querySelector('textarea[name="notes"]').value),t.append("lesson_date",e.querySelector('input[name="lesson_date"]').value),fetch(ajaxHandler.url,{method:"POST",body:t}).then(e=>e.json()).then(e=>{e.success?alert(e.data):alert("Ошибка при збережені інформації.")}).catch(e=>{console.error("Error:",e),alert("Ошибка при збережені інформації.")})})}),document.querySelectorAll('input[name="grade"]').forEach(function(e){e.addEventListener("change",function(){var e=this.closest(".js-student-feedback-form"),t=e.querySelector('input[name="student_id"]').value,n=document.getElementById("grade-status-"+t),a=new FormData;a.append("action","update_student_grade"),a.append("security",ajaxHandler.nonce),a.append("lesson_id",e.querySelector('input[name="lesson_id"]').value),a.append("student_id",t),a.append("grade",this.value),a.append("lesson_date",e.querySelector('input[name="lesson_date"]').value),fetch(ajaxHandler.url,{method:"POST",body:a}).then(e=>e.json()).then(e=>{e.success?(n.textContent="Оцінка оновлена",n.style.display="inline",setTimeout(()=>{n.style.display="none"},5e3)):alert("Помилка: "+e.data)}).catch(e=>{console.error("Error:",e),alert("Виникла помилка при збереженні оцінки.")})})}),document.querySelectorAll('input[name="attendance"]').forEach(function(e){e.addEventListener("change",function(){var e=this.closest(".js-student-feedback-form"),t=e.querySelector('input[name="student_id"]').value,n=document.getElementById("grade-status-"+t),a=new FormData;a.append("action","update_student_attendance"),a.append("lesson_id",e.querySelector('input[name="lesson_id"]').value),a.append("student_id",t),a.append("attendance",this.checked?1:0),a.append("lesson_date",e.querySelector('input[name="lesson_date"]').value),fetch(ajaxHandler.url,{method:"POST",body:a}).then(e=>e.json()).then(e=>{e.success?(n.textContent="Відвідування оновлене",n.style.display="inline",setTimeout(()=>{n.style.display="none"},5e3)):console.error("Error updating attendance.")}).catch(e=>{console.error("Error:",e)})})}),document.querySelectorAll(".js-accordion-btn").forEach(function(a){a.addEventListener("click",function(){var e=a.closest(".js-parent-accordion"),t=e.querySelector(".js-accordion-item"),n=a.getAttribute("aria-label");t.classList.contains("is-open")?(t.classList.remove("is-open"),t.classList.add("is-close"),e.classList.remove("is-open-parent"),a.setAttribute("aria-label","Зачинити вікно детальної інформації")):(t.classList.remove("is-close"),t.classList.add("is-open"),e.classList.add("is-open-parent"),a.setAttribute("aria-label",n))})})});